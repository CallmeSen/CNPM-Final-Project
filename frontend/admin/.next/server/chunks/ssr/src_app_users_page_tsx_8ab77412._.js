module.exports=[15197,a=>{"use strict";a.s(["default",()=>h],15197);var b=a.i(87924),c=a.i(83468),d=a.i(72131),e=a.i(21689),f=a.i(71682);let g=function(){let[a,c]=(0,d.useState)([]),[g,h]=(0,d.useState)([]),[i,j]=(0,d.useState)("all"),[k,l]=(0,d.useState)(""),[m,n]=(0,d.useState)(""),[o,p]=(0,d.useState)(!0),[q,r]=(0,d.useState)(""),[s,t]=(0,d.useState)(!1),[u,v]=(0,d.useState)(!1),[w,x]=(0,d.useState)(!1),[y,z]=(0,d.useState)(!1),[A,B]=(0,d.useState)(null),[C,D]=(0,d.useState)([]),[E,F]=(0,d.useState)({}),[G,H]=(0,d.useState)({userType:"customer",firstName:"",lastName:"",email:"",phone:"",password:"",role:"admin",permissions:[],restaurantId:""}),I=["manage-users","manage-restaurants","manage-orders","view-reports","manage-payments"];(0,d.useEffect)(()=>{let a=localStorage.getItem("superAdminName");a&&r(a),J()},[]),(0,d.useEffect)(()=>{let b=a;"all"!==i&&(b=b.filter(a=>a.userType===i)),k&&(b=b.filter(a=>`${a.firstName} ${a.lastName}`.toLowerCase().includes(k.toLowerCase())||a.email.toLowerCase().includes(k.toLowerCase()))),h(b)},[a,i,k]);let J=async()=>{p(!0);try{let a=localStorage.getItem("token"),b=await fetch("http://localhost:5001/api/management/users",{headers:{Authorization:`Bearer ${a}`}});if(b.ok){let a=await b.json();c(a)}else{let a=await b.json();n(a.message||"Failed to fetch users")}}catch(a){n("Server error while fetching users"),console.error(a)}finally{p(!1)}},K=a=>{let{name:b,value:c}=a.target;H({...G,[b]:c})},L=a=>{let b=G.permissions.includes(a)?G.permissions.filter(b=>b!==a):[...G.permissions,a];H({...G,permissions:b})},M=async a=>{if(a.preventDefault(),G.password.length<6){F({password:"Máº­t kháº©u pháº£i cÃ³ Ã­t nháº¥t 6 kÃ½ tá»±"}),alert("Máº­t kháº©u pháº£i cÃ³ Ã­t nháº¥t 6 kÃ½ tá»±");return}F({});try{let a=localStorage.getItem("token"),b=await fetch("http://localhost:5001/api/management/users",{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify(G)}),c=await b.json();b.ok?(alert(c.message),t(!1),R(),J()):alert(c.message||"Failed to create user")}catch(a){alert("Server error during user creation"),console.error(a)}},N=async a=>{if(a.preventDefault(),G.password&&G.password.length<6){F({password:"Máº­t kháº©u pháº£i cÃ³ Ã­t nháº¥t 6 kÃ½ tá»±"}),alert("Máº­t kháº©u pháº£i cÃ³ Ã­t nháº¥t 6 kÃ½ tá»±");return}F({});try{let a=localStorage.getItem("token"),b=await fetch(`http://localhost:5001/api/management/users/${A._id}`,{method:"PUT",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify(G)}),c=await b.json();b.ok?(alert(c.message),v(!1),R(),J()):alert(c.message||"Failed to update user")}catch(a){alert("Server error during user update"),console.error(a)}},O=async a=>{if(window.confirm(`Are you sure you want to delete ${a.firstName} ${a.lastName}?`))try{let b=localStorage.getItem("token"),c=await fetch(`http://localhost:5001/api/management/users/${a._id}?userType=${a.userType}`,{method:"DELETE",headers:{Authorization:`Bearer ${b}`}}),d=await c.json();c.ok?(alert(d.message),J()):alert(d.message||"Failed to delete user")}catch(a){alert("Server error during deletion"),console.error(a)}},P=async a=>{B(a),x(!0);try{let b=localStorage.getItem("token"),c=await fetch(`http://localhost:5001/api/management/users/${a._id}/logs`,{headers:{Authorization:`Bearer ${b}`}});if(c.ok){let a=await c.json();D(a)}}catch(a){console.error("Error fetching logs:",a)}},Q=async()=>{try{let a=localStorage.getItem("token"),b=await fetch(`http://localhost:5001/api/management/users/${A._id}/permissions`,{method:"PATCH",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({permissions:G.permissions})}),c=await b.json();b.ok?(alert(c.message),z(!1),J()):alert(c.message||"Failed to update permissions")}catch(a){alert("Server error during permissions update"),console.error(a)}},R=()=>{H({userType:"customer",firstName:"",lastName:"",email:"",phone:"",password:"",role:"admin",permissions:[],restaurantId:""}),B(null)};return(0,b.jsxs)("div",{className:"dashboard-layout",children:[(0,b.jsx)(e.default,{}),(0,b.jsxs)("main",{className:"main-content",children:[(0,b.jsxs)("div",{className:"dashboard-header",children:[(0,b.jsx)("h1",{children:"User Management"}),(0,b.jsx)("div",{className:"user-profile",children:(0,b.jsxs)("strong",{children:["Welcome, ",q," ðŸ‘‹"]})})]}),(0,b.jsxs)("div",{className:"content-area",children:[(0,b.jsxs)("div",{className:"page-header",children:[(0,b.jsx)("h2",{children:"ðŸ‘¥ Manage Users"}),(0,b.jsxs)("button",{className:"btn btn-primary",onClick:()=>t(!0),children:[(0,b.jsx)(f.FaPlus,{})," Add New User"]})]}),(0,b.jsxs)("div",{className:"filters-section",children:[(0,b.jsxs)("div",{className:"filter-group",children:[(0,b.jsx)("label",{children:"Filter by Type:"}),(0,b.jsxs)("select",{value:i,onChange:a=>j(a.target.value),className:"filter-select",children:[(0,b.jsx)("option",{value:"all",children:"All Users"}),(0,b.jsx)("option",{value:"customer",children:"Customers"}),(0,b.jsx)("option",{value:"restaurant",children:"Restaurants"}),(0,b.jsx)("option",{value:"admin",children:"Admins"}),(0,b.jsx)("option",{value:"delivery",children:"Delivery Personnel"})]})]}),(0,b.jsx)("div",{className:"search-container",children:(0,b.jsx)("input",{type:"text",placeholder:"Search by name or email...",value:k,onChange:a=>l(a.target.value),className:"search-input"})})]}),m&&(0,b.jsx)("p",{className:"error",children:m}),o?(0,b.jsx)("p",{children:"Loading users..."}):(0,b.jsxs)("div",{className:"table-wrapper",children:[(0,b.jsxs)("table",{children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{children:"Type"}),(0,b.jsx)("th",{children:"Name"}),(0,b.jsx)("th",{children:"Email"}),(0,b.jsx)("th",{children:"Phone"}),(0,b.jsx)("th",{children:"Role/Permissions"}),(0,b.jsx)("th",{children:"Actions"})]})}),(0,b.jsx)("tbody",{children:g.map(a=>(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(a=>{let c={customer:{color:"#3498db",label:"Customer"},admin:{color:"#e74c3c",label:"Admin"},restaurant:{color:"#f39c12",label:"Restaurant"},delivery:{color:"#27ae60",label:"Delivery"}}[a]||{color:"#95a5a6",label:a};return(0,b.jsx)("span",{className:"user-type-badge",style:{backgroundColor:c.color},children:c.label})})(a.userType)}),(0,b.jsxs)("td",{children:[a.firstName," ",a.lastName]}),(0,b.jsx)("td",{children:a.email}),(0,b.jsx)("td",{children:a.phone}),(0,b.jsxs)("td",{children:["admin"===a.userType&&(0,b.jsxs)("div",{className:"permissions-preview",children:[(0,b.jsx)("span",{className:"role-badge",children:a.role}),a.permissions&&a.permissions.length>0&&(0,b.jsxs)("span",{className:"permissions-count",children:[a.permissions.length," permissions"]})]}),"admin"!==a.userType&&(0,b.jsx)("span",{className:"text-muted",children:"N/A"})]}),(0,b.jsxs)("td",{className:"action-buttons",children:[(0,b.jsx)("button",{className:"btn-icon edit",onClick:()=>{B(a),H({userType:a.userType,firstName:a.firstName,lastName:a.lastName,email:a.email,phone:a.phone,password:"",role:a.role||"admin",permissions:a.permissions||[],restaurantId:a.restaurantId||""}),v(!0)},title:"Edit",children:(0,b.jsx)(f.FaEdit,{})}),"admin"===a.userType&&(0,b.jsx)("button",{className:"btn-icon permissions",onClick:()=>(a=>{if("admin"!==a.userType)return void alert("Only admin users have permissions");B(a),H({...G,permissions:a.permissions||[]}),z(!0)})(a),title:"Manage Permissions",children:(0,b.jsx)(f.FaUserShield,{})}),(0,b.jsx)("button",{className:"btn-icon logs",onClick:()=>P(a),title:"View Activity Logs",children:(0,b.jsx)(f.FaHistory,{})}),(0,b.jsx)("button",{className:"btn-icon delete",onClick:()=>O(a),title:"Delete",children:(0,b.jsx)(f.FaTrash,{})})]})]},`${a.userType}-${a._id}`))})]}),0===g.length&&(0,b.jsx)("p",{className:"no-data",children:"No users found matching your criteria."})]})]}),s&&(0,b.jsx)("div",{className:"modal-overlay",onClick:()=>t(!1),children:(0,b.jsxs)("div",{className:"modal-content",onClick:a=>a.stopPropagation(),children:[(0,b.jsx)("h3",{children:"Create New User"}),(0,b.jsxs)("form",{onSubmit:M,children:[(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"User Type *"}),(0,b.jsxs)("select",{name:"userType",value:G.userType,onChange:K,required:!0,children:[(0,b.jsx)("option",{value:"customer",children:"Customer"}),(0,b.jsx)("option",{value:"restaurant",children:"Restaurant Admin"}),(0,b.jsx)("option",{value:"admin",children:"Admin"}),(0,b.jsx)("option",{value:"delivery",children:"Delivery Personnel"})]})]}),(0,b.jsxs)("div",{className:"form-row",children:[(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"First Name *"}),(0,b.jsx)("input",{type:"text",name:"firstName",value:G.firstName,onChange:K,required:!0})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"Last Name *"}),(0,b.jsx)("input",{type:"text",name:"lastName",value:G.lastName,onChange:K,required:!0})]})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"Email *"}),(0,b.jsx)("input",{type:"email",name:"email",value:G.email,onChange:K,required:!0})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"Phone *"}),(0,b.jsx)("input",{type:"tel",name:"phone",value:G.phone,onChange:K,required:!0})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"Password *"}),(0,b.jsx)("input",{type:"password",name:"password",value:G.password,onChange:K,required:!0,minLength:6,placeholder:"Ãt nháº¥t 6 kÃ½ tá»±"}),E.password&&(0,b.jsx)("small",{style:{color:"red",display:"block",marginTop:"4px"},children:E.password})]}),"admin"===G.userType&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"Admin Role *"}),(0,b.jsxs)("select",{name:"role",value:G.role,onChange:K,children:[(0,b.jsx)("option",{value:"admin",children:"Admin"}),(0,b.jsx)("option",{value:"super-admin",children:"Super Admin"})]})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"Permissions"}),(0,b.jsx)("div",{className:"permissions-checkboxes",children:I.map(a=>(0,b.jsxs)("label",{className:"checkbox-label",children:[(0,b.jsx)("input",{type:"checkbox",checked:G.permissions.includes(a),onChange:()=>L(a)}),a]},a))})]})]}),"restaurant"===G.userType&&(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"Restaurant ID"}),(0,b.jsx)("input",{type:"text",name:"restaurantId",value:G.restaurantId,onChange:K})]}),(0,b.jsxs)("div",{className:"form-actions",children:[(0,b.jsx)("button",{type:"button",onClick:()=>{t(!1),R()},className:"btn btn-secondary",children:"Cancel"}),(0,b.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Create User"})]})]})]})}),u&&(0,b.jsx)("div",{className:"modal-overlay",onClick:()=>v(!1),children:(0,b.jsxs)("div",{className:"modal-content",onClick:a=>a.stopPropagation(),children:[(0,b.jsx)("h3",{children:"Edit User"}),(0,b.jsxs)("form",{onSubmit:N,children:[(0,b.jsxs)("div",{className:"form-row",children:[(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"First Name *"}),(0,b.jsx)("input",{type:"text",name:"firstName",value:G.firstName,onChange:K,required:!0})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"Last Name *"}),(0,b.jsx)("input",{type:"text",name:"lastName",value:G.lastName,onChange:K,required:!0})]})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"Email *"}),(0,b.jsx)("input",{type:"email",name:"email",value:G.email,onChange:K,required:!0})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"Phone *"}),(0,b.jsx)("input",{type:"tel",name:"phone",value:G.phone,onChange:K,required:!0})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"Password (leave empty to keep current)"}),(0,b.jsx)("input",{type:"password",name:"password",value:G.password,onChange:K,placeholder:"Ãt nháº¥t 6 kÃ½ tá»± hoáº·c Ä‘á»ƒ trá»‘ng",minLength:6}),E.password&&(0,b.jsx)("small",{style:{color:"red",display:"block",marginTop:"4px"},children:E.password})]}),"admin"===G.userType&&(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"Admin Role *"}),(0,b.jsxs)("select",{name:"role",value:G.role,onChange:K,children:[(0,b.jsx)("option",{value:"admin",children:"Admin"}),(0,b.jsx)("option",{value:"super-admin",children:"Super Admin"})]})]}),(0,b.jsxs)("div",{className:"form-actions",children:[(0,b.jsx)("button",{type:"button",onClick:()=>{v(!1),R()},className:"btn btn-secondary",children:"Cancel"}),(0,b.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Save Changes"})]})]})]})}),y&&A&&(0,b.jsx)("div",{className:"modal-overlay",onClick:()=>z(!1),children:(0,b.jsxs)("div",{className:"modal-content",onClick:a=>a.stopPropagation(),children:[(0,b.jsxs)("h3",{children:["Manage Permissions - ",A.firstName," ",A.lastName]}),(0,b.jsxs)("div",{className:"permissions-manager",children:[(0,b.jsx)("p",{className:"help-text",children:"Select the permissions you want to grant to this admin:"}),(0,b.jsx)("div",{className:"permissions-checkboxes",children:I.map(a=>(0,b.jsxs)("label",{className:"checkbox-label",children:[(0,b.jsx)("input",{type:"checkbox",checked:G.permissions.includes(a),onChange:()=>L(a)}),(0,b.jsx)("span",{children:a})]},a))})]}),(0,b.jsxs)("div",{className:"form-actions",children:[(0,b.jsx)("button",{onClick:()=>z(!1),className:"btn btn-secondary",children:"Cancel"}),(0,b.jsx)("button",{onClick:Q,className:"btn btn-primary",children:"Update Permissions"})]})]})}),w&&A&&(0,b.jsx)("div",{className:"modal-overlay",onClick:()=>x(!1),children:(0,b.jsxs)("div",{className:"modal-content logs-modal",onClick:a=>a.stopPropagation(),children:[(0,b.jsxs)("h3",{children:["Activity Logs - ",A.firstName," ",A.lastName]}),(0,b.jsx)("div",{className:"logs-container",children:0===C.length?(0,b.jsx)("p",{className:"no-data",children:"No activity logs available."}):(0,b.jsxs)("table",{className:"logs-table",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{children:"Action"}),(0,b.jsx)("th",{children:"Timestamp"}),(0,b.jsx)("th",{children:"IP Address"}),(0,b.jsx)("th",{children:"Status"})]})}),(0,b.jsx)("tbody",{children:C.map(a=>(0,b.jsxs)("tr",{className:a.suspicious?"suspicious-activity":"",children:[(0,b.jsxs)("td",{children:[a.action,a.suspicious&&(0,b.jsx)(f.FaExclamationTriangle,{className:"warning-icon"})]}),(0,b.jsx)("td",{children:new Date(a.timestamp).toLocaleString()}),(0,b.jsx)("td",{children:a.ipAddress}),(0,b.jsx)("td",{children:(0,b.jsx)("span",{className:`status-badge status-${a.status}`,children:a.status})})]},a.id))})]})}),(0,b.jsx)("div",{className:"form-actions",children:(0,b.jsx)("button",{onClick:()=>x(!1),className:"btn btn-primary",children:"Close"})})]})})]})]})},h=()=>(0,b.jsx)(c.default,{children:(0,b.jsx)(g,{})})}];

//# sourceMappingURL=src_app_users_page_tsx_8ab77412._.js.map