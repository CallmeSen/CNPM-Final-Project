(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,13816,t=>{"use strict";t.s(["CartContext",()=>n,"CartProvider",()=>u]);var r=t.i(43476),e=t.i(71645);let n=(0,e.createContext)({cartItems:[],addToCart:()=>void 0,removeFromCart:()=>void 0,updateQuantity:()=>void 0,clearCart:()=>void 0}),l=()=>{let t=window.localStorage;if(!t)return null;let r=t.getItem("token");if(!r)return null;try{var e;let t=JSON.parse(atob(null!=(e=r.split(".")[1])?e:""));return(null==t?void 0:t.id)||(null==t?void 0:t.userId)||(null==t?void 0:t._id)||null}catch(t){return console.error("Error decoding token:",t),null}},a=()=>{let t=l();return t?"cart_".concat(t):"cart_guest"},o=t=>t.map(t=>({...t,quantity:"number"==typeof t.quantity&&t.quantity>0?Math.floor(t.quantity):1})),i=()=>{let t=window.localStorage;if(!t)return[];try{let r=t.getItem(a());if(!r)return[];let e=JSON.parse(r);return Array.isArray(e)?o(e):[]}catch(t){return console.error("Error loading cart:",t),[]}},u=t=>{let{children:u}=t,[d,s]=(0,e.useState)(()=>i()),[c,f]=(0,e.useState)(()=>l());(0,e.useEffect)(()=>{(t=>{let r=window.localStorage;if(r)try{r.setItem(a(),JSON.stringify(o(t)))}catch(t){console.error("Error saving cart:",t)}})(d)},[d]),(0,e.useEffect)(()=>{let t=()=>{let t=l();t!==c&&(f(t),s(i()))};return window.addEventListener("storage",t),()=>window.removeEventListener("storage",t)},[c]);let y=(0,e.useCallback)((t,r)=>{s(e=>{var n;let l=null!=(n=null!=r?r:t.restaurantId)?n:null,a="string"==typeof t._id&&t._id.length>0?t._id:null,o=e.findIndex(r=>{if(a&&r._id===a)return!0;if(!a){var e,n;let a="string"==typeof r.name&&"string"==typeof t.name&&r.name.trim().toLowerCase()===t.name.trim().toLowerCase(),o=null!=(e=r.restaurantId)?e:null,i=null!=l?l:null!=(n=t.restaurantId)?n:null;return a&&o===i}return!1});if(-1!==o){let t=[...e],r=t[o],n="number"==typeof r.quantity&&r.quantity>0?Math.floor(r.quantity):1;return t[o]={...r,quantity:n+1},t}let i="number"==typeof t.quantity&&t.quantity>0?Math.floor(t.quantity):1;return[...e,{...t,restaurantId:l,quantity:i}]})},[]),m=(0,e.useCallback)(t=>{s(r=>r.filter(r=>r._id!==t))},[]),v=(0,e.useCallback)((t,r)=>{s(e=>r<=0?e.filter(r=>r._id!==t):e.map(e=>e._id===t?{...e,quantity:Math.floor(r)}:e))},[]),g=(0,e.useCallback)(()=>{let t=window.localStorage;t&&t.removeItem(a()),s([])},[]),C=(0,e.useMemo)(()=>({cartItems:d,addToCart:y,removeFromCart:m,updateQuantity:v,clearCart:g}),[d,y,m,v,g]);return(0,r.jsx)(n.Provider,{value:C,children:u})}},44636,t=>{"use strict";t.s(["default",()=>n]);var r=t.i(43476),e=t.i(13816);let n=t=>{let{children:n}=t;return(0,r.jsx)(e.CartProvider,{children:n})}}]);